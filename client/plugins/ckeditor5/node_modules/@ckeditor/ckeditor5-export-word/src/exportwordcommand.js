/*
 *             Copyright (c) 2016 - 2020, CKSource - Frederico Knabben. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import _0x477e12 from'@ckeditor/ckeditor5-core/src/command';import{getStyles as _0x737d27,getConverterOptions as _0x185b68}from'./utils';export default class c extends _0x477e12{constructor(_0x58b03f){super(_0x58b03f),this['set']('isBusy',!0x1);}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0x57f475={}){const _0x3d6f5b=this['editor'],t=_0x3d6f5b['t'],_0x108a36=_0x57f475['converterUrl']||'https://docx-converter.cke-cs.com/v1/convert',_0x4df711=_0x57f475['converterOptions']||{},_0x2b13e9=!0x1!==_0x4df711['auto_pagination'];return this['isBusy']=!0x0,this['refresh'](),_0x737d27(_0x57f475['stylesheets']||['EDITOR_STYLES'])['then'](_0x55fbf9=>{const _0x1271c8=_0x3d6f5b['getData']({'pagination':_0x2b13e9}),_0x2b426a={'html':'<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0x3d6f5b['locale']['contentLanguageDirection']+'\x22>'+_0x1271c8+'</div>','css':_0x55fbf9,'options':{..._0x4df711,..._0x185b68(_0x3d6f5b)}},_0x6a25af={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/docx',..._0x57f475['token']&&{'Authorization':_0x57f475['token']['value']}},'body':JSON['stringify'](_0x2b426a)};return window['fetch'](_0x108a36,_0x6a25af)['then'](_0x24ab55=>{if(0xc8!==_0x24ab55['status'])throw _0x24ab55;return _0x24ab55['blob']();})['then'](_0x49ae4e=>{this['o'](_0x49ae4e,_0x57f475['fileName']||'document.docx');});})['catch'](_0x4faa44=>{throw _0x3d6f5b['plugins']['get']('Notification')['showWarning'](t('An\x20error\x20occurred\x20while\x20generating\x20the\x20Word\x20file.')),_0x4faa44;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['o'](_0x4b9f20,_0x55a1ad){const _0x2ba702=document['createElement']('a');_0x2ba702['href']=window['URL']['createObjectURL'](_0x4b9f20),_0x2ba702['download']=_0x55a1ad,_0x2ba702['click'](),_0x2ba702['remove']();}}