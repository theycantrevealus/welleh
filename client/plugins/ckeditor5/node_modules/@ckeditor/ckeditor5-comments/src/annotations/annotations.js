/*
 *             Copyright (c) 2016 - 2020, CKSource - Frederico Knabben. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x377d=['getTarget','switchTo','_getOrderInContent','set','fire','cancel','left','max','context','_uis','getAnnotationView','customView','annotations-invalid-target','Annotations','_customViewToAnnotationView','register','targetRect','resize','_sortAnnotations','items','destroy','locale','length','removeEventListener','annotations-register-already-registered','top','detach','focusTracker','annotations-register-invalid-interface','activeView','change:isFocused','annotations-switchto-missing-ui','_updateAnnotationTargetRect','add','_customViewToTarget','get','_updateAnnotationsTargetRect','uiType','pluginName','attach','function','refresh','map','delete','render','sort','from','selectedViews','_throttledOrderUpdate','has','isActive','remove','init'];(function(_0x4c97ed,_0x377d40){const _0x5293e1=function(_0x12e462){while(--_0x12e462){_0x4c97ed['push'](_0x4c97ed['shift']());}};_0x5293e1(++_0x377d40);}(_0x377d,0x1a6));const _0x5293=function(_0x4c97ed,_0x377d40){_0x4c97ed=_0x4c97ed-0x0;let _0x5293e1=_0x377d[_0x4c97ed];return _0x5293e1;};import _0x3c6868 from'@ckeditor/ckeditor5-core/src/contextplugin';import _0x1953f7 from'../annotations/view/annotationview';import _0x5f244f from'@ckeditor/ckeditor5-utils/src/collection';import _0x34bbc8 from'@ckeditor/ckeditor5-utils/src/focustracker';import _0x5ce28e from'@ckeditor/ckeditor5-utils/src/dom/rect';import _0x4240d4 from'@ckeditor/ckeditor5-utils/src/ckeditorerror';import{throttle as _0x1ee82e,isElement as _0x14abd1}from'lodash-es';import'../../theme/annotation.css';export default class g extends _0x3c6868{static get[_0x5293('0x28')](){return _0x5293('0xf');}constructor(_0x1f6e94){super(_0x1f6e94),this[_0x5293('0x15')]=new _0x5f244f(),this[_0x5293('0x5')](_0x5293('0x31'),[]),this[_0x5293('0x5')]('activeView',null),this['on']('change:activeView',(_0x5c4b49,_0x25db9c,_0x23431c,_0x40661d)=>{const _0x46ee06=this[_0x5293('0x10')]['get'](_0x40661d);_0x40661d&&_0x46ee06&&(_0x46ee06['isActive']=!0x1),_0x23431c&&(this[_0x5293('0x10')]['get'](_0x23431c)[_0x5293('0x34')]=!0x0);}),this[_0x5293('0x1d')]=new _0x34bbc8(),this[_0x5293('0x1d')]['on'](_0x5293('0x20'),(_0x2e8d0d,_0x33d6b9,_0x332dec)=>{_0x332dec||(this[_0x5293('0x1f')]=null);}),this[_0x5293('0x27')]='',this['_uis']=new Map(),this[_0x5293('0x10')]=new Map(),this['_customViewToTarget']=new Map(),this[_0x5293('0x32')]=_0x1ee82e(()=>{this[_0x5293('0x26')](),this[_0x5293('0x14')]();},0x190,{'leading':!0x1});}[_0x5293('0x1')](){window['addEventListener'](_0x5293('0x13'),this['_throttledOrderUpdate']);}[_0x5293('0x11')](_0x47673f,_0x194085){if(this[_0x5293('0xb')][_0x5293('0x33')](_0x47673f))throw new _0x4240d4(_0x5293('0x1a'));if(_0x5293('0x2a')!=typeof _0x194085[_0x5293('0x29')]||_0x5293('0x2a')!=typeof _0x194085[_0x5293('0x1c')])throw new _0x4240d4(_0x5293('0x1e'));this[_0x5293('0xb')]['set'](_0x47673f,_0x194085);}[_0x5293('0x3')](_0x21ac8d){if(!this['_uis'][_0x5293('0x33')](_0x21ac8d))throw new _0x4240d4(_0x5293('0x21'),this);this[_0x5293('0x27')]!==_0x21ac8d&&(this[_0x5293('0x27')]&&this[_0x5293('0xb')]['get'](this[_0x5293('0x27')])[_0x5293('0x1c')](),this[_0x5293('0x27')]=_0x21ac8d,this[_0x5293('0xb')][_0x5293('0x25')](this[_0x5293('0x27')])[_0x5293('0x29')]());}[_0x5293('0x23')](_0x20ff31,_0x3e89d6){if(this['_customViewToAnnotationView'][_0x5293('0x33')](_0x20ff31))throw new _0x4240d4('annotations-duplicated-item',this);const _0x2133b7=new _0x1953f7(this[_0x5293('0xa')][_0x5293('0x17')],_0x20ff31);_0x2133b7[_0x5293('0x2e')](),this[_0x5293('0x1d')][_0x5293('0x23')](_0x2133b7['element']),_0x2133b7[_0x5293('0x1d')]['on'](_0x5293('0x20'),(_0x4c70bb,_0x66ebb1,_0x120ba8)=>{_0x120ba8&&(this[_0x5293('0x1f')]=_0x20ff31);}),this[_0x5293('0x24')][_0x5293('0x5')](_0x20ff31,_0x3e89d6),this[_0x5293('0x22')](_0x2133b7);const _0x2f58e1=this['_getOrderInContent'](_0x2133b7[_0x5293('0x12')]);return this[_0x5293('0x15')][_0x5293('0x23')](_0x2133b7,_0x2f58e1),this[_0x5293('0x10')][_0x5293('0x5')](_0x20ff31,_0x2133b7),_0x2133b7;}['remove'](_0x220210){if(!this[_0x5293('0x10')][_0x5293('0x33')](_0x220210))return;const _0x36cc2b=this[_0x5293('0x10')][_0x5293('0x25')](_0x220210);this[_0x5293('0x1d')][_0x5293('0x0')](_0x36cc2b['element']),this['activeView']===_0x220210&&(this[_0x5293('0x1f')]=null),this[_0x5293('0x15')][_0x5293('0x0')](_0x36cc2b),_0x36cc2b['destroy'](),this['_customViewToTarget'][_0x5293('0x2d')](_0x220210),this[_0x5293('0x10')][_0x5293('0x2d')](_0x220210);}[_0x5293('0x2')](_0x29b177){const _0x4ca86d=this[_0x5293('0x24')][_0x5293('0x25')](_0x29b177)||null;return'function'==typeof _0x4ca86d?_0x4ca86d():_0x4ca86d;}[_0x5293('0xc')](_0x2fbafe){return this['_customViewToAnnotationView'][_0x5293('0x25')](_0x2fbafe);}[_0x5293('0x2b')](){this[_0x5293('0x6')](_0x5293('0x2b')),this[_0x5293('0x32')]();}[_0x5293('0x16')](){super[_0x5293('0x16')](),window[_0x5293('0x19')](_0x5293('0x13'),this[_0x5293('0x32')]),this['_throttledOrderUpdate'][_0x5293('0x7')](),this[_0x5293('0x15')][_0x5293('0x2c')](_0x218a39=>_0x218a39[_0x5293('0x16')]());}['_updateAnnotationsTargetRect'](){for(const _0x48f18e of this[_0x5293('0x15')])this['_updateAnnotationTargetRect'](_0x48f18e);}[_0x5293('0x22')](_0x15fbfa){const _0x49287d=this[_0x5293('0x2')](_0x15fbfa[_0x5293('0xd')]);if(null!==_0x49287d){if(!(_0x49287d instanceof _0x5ce28e||_0x14abd1(_0x49287d)))throw new _0x4240d4(_0x5293('0xe'));_0x15fbfa[_0x5293('0x12')]=new _0x5ce28e(_0x49287d);}}[_0x5293('0x14')](){const _0x356b79=Array[_0x5293('0x30')](this[_0x5293('0x15')])[_0x5293('0x2f')]((_0xca5d2,_0xa4bc5f)=>k(_0xca5d2[_0x5293('0x12')],_0xa4bc5f[_0x5293('0x12')]));for(let _0x1ae829=_0x356b79[_0x5293('0x18')]-0x1;_0x1ae829>0x0;_0x1ae829--){const _0x51fe2a=_0x356b79[_0x1ae829];_0x1ae829!==this[_0x5293('0x15')]['getIndex'](_0x51fe2a)&&(this[_0x5293('0x15')][_0x5293('0x0')](_0x51fe2a),this[_0x5293('0x15')]['add'](_0x51fe2a,_0x1ae829));}}[_0x5293('0x4')](_0x57b08d){let _0x1ba460=0x0;for(const _0x4049da of this[_0x5293('0x15')]){const _0x39cd61=this[_0x5293('0x2')](_0x4049da[_0x5293('0xd')]);if(_0x39cd61){if(k(_0x57b08d,new _0x5ce28e(_0x39cd61))<0x0)return _0x1ba460;_0x1ba460++;}}return Math[_0x5293('0x9')](0x0,_0x1ba460);}}function k(_0x12f75a,_0x9432e4){const _0x33070c=_0x12f75a[_0x5293('0x1b')]-_0x9432e4['top'];return 0x0==_0x33070c?_0x12f75a[_0x5293('0x8')]-_0x9432e4[_0x5293('0x8')]:_0x33070c;}