/*
 *             Copyright (c) 2016 - 2020, CKSource - Frederico Knabben. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x3ca9=['getRanges','from','refresh','update','requires','element','selection','focusTracker','add','isReadOnly','remove','keys','document','view','change:isFocused','has','cancel','editor','stop','init','_dataCollectors','plugins','containsRange','refreshSelectedViews','push','addSourceCollector','editing','items','Annotations','listenTo','activeView','model','directChange','get','selectedViews','sort','set','_findSelectedViews','_editorAnnotationsData','customView'];(function(_0xf2f046,_0x3ca997){const _0x5a00fb=function(_0x4265fd){while(--_0x4265fd){_0xf2f046['push'](_0xf2f046['shift']());}};_0x5a00fb(++_0x3ca997);}(_0x3ca9,0xa3));const _0x5a00=function(_0xf2f046,_0x3ca997){_0xf2f046=_0xf2f046-0x0;let _0x5a00fb=_0x3ca9[_0xf2f046];return _0x5a00fb;};import _0x1f699f from'@ckeditor/ckeditor5-core/src/plugin';import _0x22d143 from'./annotations';import _0x56437b from'./inlineannotations';import _0x1462f0 from'@ckeditor/ckeditor5-utils/src/ckeditorerror';import{debounce as _0x5e6b63}from'lodash-es';export default class y extends _0x1f699f{static get[_0x5a00('0x1')](){return[_0x22d143,_0x56437b];}static get['pluginName'](){return'EditorAnnotations';}constructor(_0x428d97){super(_0x428d97),this[_0x5a00('0x11')]=new Set();}[_0x5a00('0x10')](){const _0x333139=this[_0x5a00('0xe')],_0x492f7d=_0x333139[_0x5a00('0x12')][_0x5a00('0x1e')](_0x5a00('0x19')),_0x1d49ae=_0x333139[_0x5a00('0x1c')][_0x5a00('0x9')]['selection'],_0x2665ed=_0x5e6b63(()=>this[_0x5a00('0x14')](),0xa);_0x1d49ae['on']('change:range',(_0x632e4f,_0x4a24a9)=>{_0x4a24a9[_0x5a00('0x1d')]&&(_0x2665ed[_0x5a00('0xd')](),this[_0x5a00('0x14')]());}),this[_0x5a00('0x1a')](_0x333139[_0x5a00('0x17')][_0x5a00('0xa')][_0x5a00('0x9')],_0x5a00('0xb'),(_0x586b76,_0xc8f316,_0x5bb454)=>{_0x5bb454&&_0x2665ed();}),this[_0x5a00('0x1a')](_0x333139['ui'][_0x5a00('0x4')],_0x5a00('0xb'),(_0x2ac18d,_0x14784f,_0x1d2149)=>{_0x1d2149||_0x333139[_0x5a00('0x6')]||this[_0x5a00('0x23')][_0x5a00('0xc')](_0x492f7d['activeView'])&&(_0x492f7d[_0x5a00('0x1b')]=null);}),_0x492f7d['focusTracker']['on'](_0x5a00('0xb'),(_0x3b32a7,_0x2d2b1f,_0x1a0a3b)=>{!_0x1a0a3b&&_0x333139['editing'][_0x5a00('0xa')]['hasDomSelection']&&(_0x2665ed['cancel'](),this[_0x5a00('0x14')](),_0x3b32a7[_0x5a00('0xf')]());},{'priority':'high'}),this[_0x5a00('0x1a')](this[_0x5a00('0xe')]['ui'],_0x5a00('0x0'),()=>_0x492f7d[_0x5a00('0x27')]());const _0x4956a0=new Set();this[_0x5a00('0x1a')](_0x492f7d[_0x5a00('0x18')],_0x5a00('0x5'),(_0x13962e,_0x1f1c37)=>{for(const _0xa854ef of this['_editorAnnotationsData'][_0x5a00('0x8')]())if(_0xa854ef===_0x1f1c37[_0x5a00('0x24')]){_0x333139['ui']['focusTracker'][_0x5a00('0x5')](_0x1f1c37[_0x5a00('0x2')]),_0x4956a0[_0x5a00('0x5')](_0x1f1c37);break;}}),this[_0x5a00('0x1a')](_0x492f7d[_0x5a00('0x18')],_0x5a00('0x7'),(_0x2b16bd,_0x587abc)=>{_0x4956a0[_0x5a00('0xc')](_0x587abc)&&(_0x333139['ui'][_0x5a00('0x4')][_0x5a00('0x7')](_0x587abc[_0x5a00('0x2')]),_0x4956a0['delete'](_0x587abc));});}[_0x5a00('0x16')](_0x500bb9){if('function'!=typeof _0x500bb9)throw new _0x1462f0('editorannotations-invalid-source-callback');this[_0x5a00('0x11')][_0x5a00('0x5')](_0x500bb9);}[_0x5a00('0x14')](){const _0x51e909=this[_0x5a00('0xe')][_0x5a00('0x12')]['get']('Annotations');_0x51e909[_0x5a00('0x1f')]=this[_0x5a00('0x22')](),_0x51e909[_0x5a00('0x1b')]=_0x51e909['selectedViews'][0x0]||null;}get[_0x5a00('0x23')](){const _0x1260cc=new Map();for(const _0x25c527 of Array[_0x5a00('0x26')](this[_0x5a00('0x11')]))for(const [_0x4f2d25,_0x35b1dd]of _0x25c527())_0x1260cc[_0x5a00('0x21')](_0x4f2d25,_0x35b1dd);return _0x1260cc;}[_0x5a00('0x22')](){const _0xc7ea5f=[],_0x197b55=this[_0x5a00('0xe')][_0x5a00('0x1c')][_0x5a00('0x9')][_0x5a00('0x3')],_0x188760=Array[_0x5a00('0x26')](_0x197b55[_0x5a00('0x25')]()),_0x1c7170=this['editor']['plugins'][_0x5a00('0x1e')](_0x5a00('0x19'));for(const [_0x1a6eb1,_0x53f351]of this[_0x5a00('0x23')]){const _0x2563e9=_0x43b895(_0x53f351);_0x2563e9&&_0xc7ea5f[_0x5a00('0x15')]([_0x1a6eb1,_0x2563e9]);}function _0x43b895(_0x5da91f){for(const _0x3186af of _0x5da91f)for(const _0x3f272d of _0x188760)if(_0x3186af[_0x5a00('0x13')](_0x3f272d,!_0x197b55['isCollapsed']))return _0x3186af;return null;}return _0xc7ea5f[_0x5a00('0x20')]((_0x1b199a,_0xc398a2)=>{const _0x59dc90=_0x1b199a[0x1],_0x748620=_0xc398a2[0x1];return _0x59dc90[_0x5a00('0x13')](_0x748620)?0x1:_0x748620[_0x5a00('0x13')](_0x59dc90)||_0x1b199a[0x0]==_0x1c7170['activeView']?-0x1:_0xc398a2[0x0]==_0x1c7170[_0x5a00('0x1b')]?0x1:0x0;})['map'](_0x22fea4=>_0x22fea4[0x0]);}}